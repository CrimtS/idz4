# ИДЗ № 4 по АВС, Вариант 10
Савосин Фёдор, БПИ 215
## Условие
Задача о магазине - 1. В магазине работают три отдела, каждый отдел обслуживает один продавец. 
Покупатель, зайдя в магазин, делает покупки в одном или нескольких произвольных отделах, обходя их в произвольном порядке. 
Если в выбранном отделе продавец не свободен, покупатель становится в очередь и засыпает, пока продавец не освободится. 
Создать многопоточное приложение, моделирующее рабочий день магазина.
Работу я выполнял на оценку 6

Исходный код: [main.cpp](./main.cpp)

## Модель параллельных вычислений 
В данном случае модель скорее можно описать рекурсивным параллелизмом. Потоки покупателей распределяются на отделы, затем либо возвращаются в очередь, либо покидают магазин.
В каждом из потоков клиент покупает товар, когда подходит его очередь. 
Общей целью программы является бесперебойная работа магазина и продажа товаров до последнего покупателя.

## Входные данные.

Ввод данных осуществляется с помощью командной строки.  
Пользователь вводит количество клиентов, а затем- для каждого клиента список отделов, которые он должен посетить. 
Так как в условии непонятно, должны ли списки генерироваться рандомно, я оставил пользователю возможность ввести их и не генерировал списки. 
Это дает лучшую наглядность, так как пользователь знает, как должна сработать программа и кто куда должен пойти.

Ввод проверяется на корректность, о чем пользователю подсказывает программа 
пример корректного ввода с разными случаями списков:
5
1 2 3
3 2 1
3 0 0
2 1 0
2 0 0

## Используемые сихропримитивы

В данной программе в качестве синхропримитивов используются мьютексы.
Одну кассу с продавцом в момент времени может занимать только один клиент, следовательно мьютекс идеально подходит в качестве синхропримитива.

## Поведение сущностей.
В начале подготавливается список клиентов, кассиры встают на кассы(инициализация мьютексов).
Затем клиенты по очереди согласно указаниям от жен ходят и встают в очереди в соответствующие отделы чтобы купить товары, одну кассу занимает только один покупатель.
Магазин работает до последнего клиента.

## Обобщенный алгоритм
Создается очередь покупателей, каждый из которых ждет, пока нужный ему продавец освободится(unlock mutex'a). После покупки поток либо меняет цель(кассу) и добавляется в конец очереди на нужную кассу(покупатель пошел в другой отдел и встал последним), либо покупатель покидает магазин и тогда размер очереди лишь уменьшается. Программа работает, пока размер очереди>0
